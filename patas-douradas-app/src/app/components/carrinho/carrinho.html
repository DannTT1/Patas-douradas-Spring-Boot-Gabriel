<div class="carrinho-container">
    <h2>Seu Carrinho de Compras</h2>

    <div *ngIf="errorMessage" class="message error">
        {{ errorMessage }}
    </div>
    <div *ngIf="loading" class="message info">
        Validando estoque e preços com o servidor...
    </div>

    <div *ngIf="!loading && itensLocal.length === 0" class="message empty">
        Seu carrinho está vazio. Adicione produtos na página de catálogo!
    </div>

    <div *ngIf="carrinhoValidado" class="carrinho-details">
        
        <table class="carrinho-table">
            <thead>
                <tr>
                    <th>Produto</th>
                    <th>Preço Unitário</th>
                    <th>Quantidade</th>
                    <th>Subtotal</th>
                    <th>Ação</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of carrinhoValidado.itens">
                    <td>{{ item.produto.nome }}</td>
                    <td>{{ item.produto.precoUnitario | currency:'BRL' }}</td>
                    <td>{{ item.quantidade }}</td>
                    <td>{{ item.subtotal | currency:'BRL' }}</td>
                    <td>
                        <button (click)="removerItem(item.produto.id)" class="remove-button">Remover</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="carrinho-footer">
            <h3>Total Geral: {{ carrinhoValidado.totalGeral | currency:'BRL' }}</h3>
        </div>

        <button 
            (click)="finalizarPedido()" 
            class="checkout-button"
            [disabled]="carrinhoValidado.totalGeral === 0">
            Finalizar Pedido
        </button>
    </div>
</div>