<!-- src/app/components/produtos/produtos.html -->

<div class="produtos-list-container">
    <h2>Catálogo de Produtos</h2>

    <div *ngIf="errorMessage" class="message api-error">
        {{ errorMessage }}
    </div>

    <div *ngIf="loading && !errorMessage" class="loading">
        Carregando catálogo...
    </div>

    <!-- CORREÇÃO: Abre a tag <table> se houver dados e fecha corretamente -->
    <table *ngIf="!loading && produtos.length > 0" class="produtos-table" border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Preço</th>
                <th>Estoque</th>
                <th>Ação</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let produto of produtos">
                <td>{{ produto.id }}</td>
                <td>{{ produto.nome }}</td>
                <td>{{ produto.precoUnitario | currency:'BRL' }}</td>
                <td>{{ produto.estoque }}</td>
                <td>
                    <button 
                        (click)="addToCart(produto.id)"
                        [disabled]="produto.estoque === 0"
                        class="action-button">
                        {{ produto.estoque > 0 ? 'Adicionar ao Carrinho' : 'Esgotado' }}
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <!-- Fim da tag table -->
    
    <div *ngIf="!loading && produtos.length === 0 && !errorMessage" class="message info">
        Nenhum produto encontrado na loja.
    </div>
    
    <!-- Link para Admin - Adicione um link para a rota protegida para testarmos -->
    <div style="margin-top: 20px;">
        <a routerLink="/produtos/novo">Cadastrar Novo Produto</a>
    </div>
</div>